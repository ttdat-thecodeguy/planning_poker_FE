
<mat-drawer-container class="sidenav-container" autosize="true">
  <mat-drawer #drawer class="sidenav" mode="side" [position]="'end'">
    <div class="issues-header">
      <div class="issues-header-left">
        <h3>Issues</h3>
      </div>
      <div class="issues-header-right">
        
        <div class="dropdown open">
          <span class="mr-2 icn" (click)="onRemoveAllIssue()">
            <i class="fa fa-trash" aria-hidden="true"></i>
          </span>
          <button class="btn btn-secondary dropdown-toggle btn-import-issues " type="button" id="triggerId"
            data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
            <span  ><i class="fa fa-download" aria-hidden="true"></i></span>
          </button>
          <span class="divider-module"> | </span>
          <span class="btn-close-dialog cursor-pointer" (click)="drawer.close()">&#x2715;</span>
          <div class="dropdown-menu" aria-labelledby="triggerId">
            <a class="dropdown-item" href="#">Import from Jira</a>
            <button class="dropdown-item" (click)="onUploadByUrls()">Import from Urls</button>
            <button class="dropdown-item" (click)="onOpenUploadAsCSV()">Import from CSV</button>
          </div>
        </div>
      </div>
    </div>

    <div class="issues-main">


      <div class="issue-container">
        <ng-container *ngFor="let issue of issues_arr">
          <issue [issue]="issue"></issue>
        </ng-container>
        <div class="mt-3">
          <ng-container *ngIf="isIssueOpen === true">
            <form (submit)="onSaveIssue()" [formGroup]="issueForm" >
              <mat-form-field appearance="outline" >
                <textarea matInput color="secondary" formControlName="title" name="title"  placeholder="Enter a title for the issue" class="issue-text"></textarea>
              </mat-form-field>
              <button type="button" class="w-48 mr-2"  mat-stroked-button (click)="onCloseIssue()"	>
                Cancel
              </button>
              <button type="submit" (keyup.enter)="onSaveIssue()" color="primary" class="w-48"  mat-flat-button>
                Save
              </button>
            </form>         
          </ng-container>
  
          <ng-container *ngIf="isIssueOpen === false">
            <button class="add-issue" (click)="onOpenAddIssue()">
              <i class="fa fa-plus" aria-hidden="true"></i>
              Add an issue
            </button>
          </ng-container>
        </div>   
      </div>
    </div>
  </mat-drawer>
</mat-drawer-container>

<button type="button" class="btn-fc" mat-button (click)="drawer.toggle()">
  <i class="fa fa-bars" aria-hidden="true"></i>
</button>

<button type="button" class="btn-fc" mat-button (click)="onOpenInvitePeople()">
 <i class="fa fa-user-plus" aria-hidden="true"></i>
</button>

<div class="timer">
  <button class="btn-icon">
    <i class="fa fa-clock-o" aria-hidden="true"></i>
  </button>
</div>
<div class="robot">
  <button class="btn-icon">
    <img src="assets/robot.svg" />
  </button>
</div>
<div class="container" style="margin-top: -160px;">
  

  <div class="table-container">
    
    <div class="side-left-table side-table table-items">
      <ng-container *ngFor="let i of game_play[3]">
        <deck [point]="i.point" [isFlip]="i.isFlip" [userOwnerName]="i.userOwnerName" [SpectatorMode]="i.SpectatorMode"></deck>
      </ng-container>
    </div>
    <div class="top-table table-items">
      <ng-container *ngIf="game_play[1].length !== 0">
        <ng-container *ngFor="let i of game_play[1]" >
          <deck [point]="i.point" [isFlip]="i.isFlip" [userOwner]="i.userOwner" [userOwnerName]="i.userOwnerName" [SpectatorMode]="i.SpectatorMode"></deck>
        </ng-container>
      </ng-container>
      
      <ng-container *ngIf="game_play[1].length === 0">
        <div>
          <span>Feeling lonely? 😴</span>
          <span>
            <a (click)="onHandleInviteFriend()" class="cursor-pointer text-primary nav-link">invite people</a>
          </span>
        </div>
       
      </ng-container>
    </div>

    <div class="table">
      <div class="table-items-container">
        <ng-container *ngIf="selected === undefined && isDone === false">
          <p>Pick up your cards</p>
        </ng-container>

        <ng-container *ngIf="selected !== undefined">
          <ng-container *ngIf="isDone === false">

            <ng-container *ngIf="tick === -1">
              <ng-container *ngIf="t.isShowCardByOwner === false">
                <button class="p-2" mat-flat-button color="primary" (click)="onHandleReveal()">Reveal Cards</button>
              </ng-container>
  
              <ng-container *ngIf="t.isShowCardByOwner === true">
                <button *ngIf="t.userOwerId === $auth?.id" class="p-2" mat-flat-button color="primary" (click)="onHandleReveal()">Reveal Cards</button>
                <p *ngIf="t.userOwerId !== $auth?.id">voting in progress</p>
              </ng-container>         
            </ng-container>
           
            

            <ng-container *ngIf="tick !== -1">
              <h4 class="text-primary">{{tick}}</h4>
            </ng-container>

          </ng-container>
        </ng-container>
        
        

        <ng-container *ngIf="isDone === true">
            <button class="p-2" mat-flat-button color="primary" (click)="onStartNewVoting()">start new voting</button>
        </ng-container>

      </div>
    </div>

    <div class="bottom-table table-items">
      <ng-container *ngFor="let i of game_play[0]">
        <deck [point]="i.point" [isFlip]="i.isFlip" [userOwner]="i.userOwner" [userOwnerName]="i.userOwnerName" [SpectatorMode]="i.SpectatorMode"></deck>
      </ng-container>
    </div>

    <div class="side-right-table side-table table-items">
      <ng-container *ngFor="let i of game_play[2]">
        <deck [point]="i.point" [isFlip]="i.isFlip" [userOwner]="i.userOwner" [userOwnerName]="i.userOwnerName" [SpectatorMode]="i.SpectatorMode"></deck>
      </ng-container>
    </div>
  </div>
  
  <div class="deck-container">
    

    <ng-container>
      
    </ng-container>
    <!--check spectator mode-->
    <ng-container>

    </ng-container>


    <ng-container *ngIf="isDone === true">
      

<!-- 
        <div>
          <h4>Average</h4>
          <p>6.5</p>
          <h4>Agreement:</h4>
          <div class="robot-emoji">
            <div class="agree-status"></div>
            <img src="data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMzIiIGhlaWdodD0iMjYiIHZpZXdCb3g9IjAgMCAzMiAyNiIgZmlsbD0ibm9uZSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj4KPHBhdGggZD0iTTMuMzMzMTcgMTMuMzMzM0MzLjMzMzE3IDEwLjc1NiA1LjQyMjUxIDguNjY2NjcgNy45OTk4NCA4LjY2NjY3SDIzLjk5OThDMjYuNTc3MiA4LjY2NjY3IDI4LjY2NjUgMTAuNzU2IDI4LjY2NjUgMTMuMzMzM1YyMEMyOC42NjY1IDIyLjU3NzMgMjYuNTc3MiAyNC42NjY3IDIzLjk5OTggMjQuNjY2N0g3Ljk5OTgzQzUuNDIyNTEgMjQuNjY2NyAzLjMzMzE3IDIyLjU3NzMgMy4zMzMxNyAyMFYxMy4zMzMzWiIgZmlsbD0iI0E0Q0RGRiIgc3Ryb2tlPSIjMDAyNzU1IiBzdHJva2Utd2lkdGg9IjEuMzMzMzMiLz4KPHBhdGggZmlsbC1ydWxlPSJldmVub2RkIiBjbGlwLXJ1bGU9ImV2ZW5vZGQiIGQ9Ik0yMi42NjcgMjMuOTk5N0gyNC4wMDAzQzI2LjIwOTUgMjMuOTk5NyAyOC4wMDAzIDIyLjIwODggMjguMDAwMyAxOS45OTk3VjEzLjMzM0MyOC4wMDAzIDExLjEyMzkgMjYuMjA5NSA5LjMzMzAxIDI0LjAwMDMgOS4zMzMwMUgyMi42NjdDMjQuODc2MSA5LjMzMzAxIDI2LjY2NyAxMS4xMjM5IDI2LjY2NyAxMy4zMzNWMTkuOTk5N0MyNi42NjcgMjIuMjA4OCAyNC44NzYxIDIzLjk5OTcgMjIuNjY3IDIzLjk5OTdaIiBmaWxsPSIjODBCOUZGIi8+CjxwYXRoIGQ9Ik0yLjg2ODE1IDEzLjMzMzNDMi44NjgxNSAxMC40OTkyIDUuMTY1NjggOC4yMDE2NSA3Ljk5OTg0IDguMjAxNjVIMjMuOTk5OEMyNi44MzQgOC4yMDE2NSAyOS4xMzE1IDEwLjQ5OTIgMjkuMTMxNSAxMy4zMzMzVjIwQzI5LjEzMTUgMjIuODM0MiAyNi44MzQgMjUuMTMxNyAyMy45OTk4IDI1LjEzMTdINy45OTk4M0M1LjE2NTY4IDI1LjEzMTcgMi44NjgxNSAyMi44MzQyIDIuODY4MTUgMjBWMTMuMzMzM1oiIHN0cm9rZT0iIzAwMjc1NSIgc3Ryb2tlLXdpZHRoPSIwLjQwMzI5MiIvPgo8cmVjdCB3aWR0aD0iOS4zMzMzMyIgaGVpZ2h0PSI5LjMzMzMzIiByeD0iNC42NjY2NyIgdHJhbnNmb3JtPSJtYXRyaXgoMSAwIDAgLTEgNi42NjY1IDIwLjY2NykiIGZpbGw9IiM4MEI5RkYiLz4KPHJlY3QgeD0iMC42NjY2NjciIHk9Ii0wLjY2NjY2NyIgd2lkdGg9IjgiIGhlaWdodD0iOCIgcng9IjQiIHRyYW5zZm9ybT0ibWF0cml4KDEgMCAwIC0xIDYgMTguNjY2NykiIGZpbGw9IndoaXRlIiBzdHJva2U9IiMwMDI3NTUiIHN0cm9rZS13aWR0aD0iMS4zMzMzMyIvPgo8cmVjdCB3aWR0aD0iOS4zMzMzMyIgaGVpZ2h0PSI5LjMzMzMzIiByeD0iNC42NjY2NyIgdHJhbnNmb3JtPSJtYXRyaXgoMSAwIDAgLTEgMTcuMzMzNSAyMC42NjcpIiBmaWxsPSIjODBCOUZGIi8+CjxyZWN0IHg9IjAuNjY2NjY3IiB5PSItMC42NjY2NjciIHdpZHRoPSI4IiBoZWlnaHQ9IjgiIHJ4PSI0IiB0cmFuc2Zvcm09Im1hdHJpeCgxIDAgMCAtMSAxNi42NjY1IDE4LjY2NjcpIiBmaWxsPSJ3aGl0ZSIgc3Ryb2tlPSIjMDAyNzU1IiBzdHJva2Utd2lkdGg9IjEuMzMzMzMiLz4KPHBhdGggZD0iTTMxLjc5ODQgMTguNjY2N0MzMS43OTg0IDE5LjI5MTcgMzEuMjkxNyAxOS43OTg0IDMwLjY2NjcgMTkuNzk4NEwyOS41MzUgMTkuNzk4NEwyOS41MzUgMTMuNTM1TDMwLjY2NjcgMTMuNTM1QzMxLjI5MTcgMTMuNTM1IDMxLjc5ODQgMTQuMDQxNyAzMS43OTg0IDE0LjY2NjdMMzEuNzk4NCAxOC42NjY3WiIgZmlsbD0iIzAwMjc1NSIgc3Ryb2tlPSIjMDAyNzU1IiBzdHJva2Utd2lkdGg9IjAuNDAzMjkyIi8+CjxwYXRoIGQ9Ik0yLjQ2NDg2IDE5Ljc5ODRMMS4zMzMxNyAxOS43OTg0QzAuNzA4MTU3IDE5Ljc5ODQgMC4yMDE0ODMgMTkuMjkxNyAwLjIwMTQ4MyAxOC42NjY3TDAuMjAxNDg0IDE0LjY2NjdDMC4yMDE0ODQgMTQuMDQxNyAwLjcwODE1NyAxMy41MzUgMS4zMzMxNyAxMy41MzVMMi40NjQ4NiAxMy41MzVMMi40NjQ4NiAxOS43OTg0WiIgZmlsbD0iIzAwMjc1NSIgc3Ryb2tlPSIjMDAyNzU1IiBzdHJva2Utd2lkdGg9IjAuNDAzMjkyIi8+CjxwYXRoIGQ9Ik0xNCAyMS4zMzNDMTQuMzA0MSAyMi4xMTIgMTUuMDg0OCAyMi42NjYzIDE2IDIyLjY2NjNDMTYuOTE1MiAyMi42NjYzIDE3LjY5NTkgMjIuMTEyIDE4IDIxLjMzM0gxNFoiIGZpbGw9IiMwMDI3NTUiIHN0cm9rZT0iIzAwMjc1NSIgc3Ryb2tlLXdpZHRoPSIxLjMzMzMzIiBzdHJva2UtbGluZWNhcD0icm91bmQiIHN0cm9rZS1saW5lam9pbj0icm91bmQiLz4KPHBhdGggZD0iTTIwLjY2NjUgMTMuOTk5N0MyMC42NjY1IDEzLjYzMTUgMjAuOTY1IDEzLjMzMyAyMS4zMzMyIDEzLjMzM0MyMS43MDE0IDEzLjMzMyAyMS45OTk4IDEzLjYzMTUgMjEuOTk5OCAxMy45OTk3VjE2LjY2NjNDMjEuOTk5OCAxNy4wMzQ1IDIxLjcwMTQgMTcuMzMzIDIxLjMzMzIgMTcuMzMzQzIwLjk2NSAxNy4zMzMgMjAuNjY2NSAxNy4wMzQ1IDIwLjY2NjUgMTYuNjY2M1YxMy45OTk3WiIgZmlsbD0iIzAwMjc1NSIvPgo8cGF0aCBkPSJNMTUuMzMzNSAzLjk5OTY4QzE1LjMzMzUgMy42MzE0OSAxNS42MzIgMy4zMzMwMSAxNi4wMDAyIDMuMzMzMDFDMTYuMzY4NCAzLjMzMzAxIDE2LjY2NjggMy42MzE0OCAxNi42NjY4IDMuOTk5NjdWNy45OTk2N0MxNi42NjY4IDguMzY3ODYgMTYuMzY4NCA4LjY2NjM0IDE2LjAwMDIgOC42NjYzNEMxNS42MzIgOC42NjYzNCAxNS4zMzM1IDguMzY3ODYgMTUuMzMzNSA3Ljk5OTY3VjMuOTk5NjhaIiBmaWxsPSIjMDAyNzU1Ii8+CjxwYXRoIGQ9Ik0xMCAxMy45OTk3QzEwIDEzLjYzMTUgMTAuMjk4NSAxMy4zMzMgMTAuNjY2NyAxMy4zMzNDMTEuMDM0OSAxMy4zMzMgMTEuMzMzMyAxMy42MzE1IDExLjMzMzMgMTMuOTk5N1YxNi42NjYzQzExLjMzMzMgMTcuMDM0NSAxMS4wMzQ5IDE3LjMzMyAxMC42NjY3IDE3LjMzM0MxMC4yOTg1IDE3LjMzMyAxMCAxNy4wMzQ1IDEwIDE2LjY2NjNWMTMuOTk5N1oiIGZpbGw9IiMwMDI3NTUiLz4KPGNpcmNsZSBjeD0iMTYuMDAwMiIgY3k9IjIuNjY2NjciIHI9IjIuNDY1MDIiIGZpbGw9IiMwMDI3NTUiIHN0cm9rZT0iIzAwMjc1NSIgc3Ryb2tlLXdpZHRoPSIwLjQwMzI5MiIvPgo8L3N2Zz4K" alt="">
          </div>
        </div> -->

      <app-results [result]="result"></app-results>


    </ng-container>

    <ng-container *ngIf="isDone === false">
      <div *ngIf="isSpectatorMode === false">
        <p>Choose your card 👇</p>
        <div class="d-flex" id="decklist">
          <div *ngFor="let item of voting_sys_arr">
            <!-- prevent click when clock ticking -->
            <deck *ngIf="item !== null && item !==undefined && item !== ''" [selected]="selected === item ? true : false"
              (click)="tick !== -1 ? null : onDeckSelected(item)" [point]="item"></deck>
          </div>
        </div>
      </div> 
      <div *ngIf="isSpectatorMode === true">
          <p>You are in spectator mode 👁</p>
          <a class="text-primary" (click)="onDeativateSpectator()" >Deactive</a>
      </div>   
    </ng-container>
    
  </div>
</div>